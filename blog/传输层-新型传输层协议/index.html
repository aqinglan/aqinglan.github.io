<!DOCTYPE html><html lang="zh-CN, en-US"><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="IE=edge" http-equiv=X-UA-Compatible><title>传输层-新型传输层协议 • Akiのink</title><link href=/favicon/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon/favicon-32x32.png rel=icon type=image/png sizes=32x32><link href=/favicon/favicon-16x16.png rel=icon type=image/png sizes=16x16><link href=/favicon/site.webmanifest rel=manifest><link href=/fonts/Satoshi-Variable.ttf rel=preload type=font/ttf as=font crossorigin><link href=/fonts/Satoshi-VariableItalic.ttf rel=preload type=font/ttf as=font crossorigin><link href=https://astro-theme-pure.vercel.app/blog/%E4%BC%A0%E8%BE%93%E5%B1%82-%E6%96%B0%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE rel=canonical><meta content="传输层-新型传输层协议 • Akiのink" name=title><meta content=" 对应 北京大学计算机网络课程第三讲第五部分 参考教材计算机网络-自顶向下方法" name=description><meta content=Aki name=author><meta content="" name=theme-color><meta content=article property=og:type><meta content=传输层-新型传输层协议 property=og:title><meta content=" 对应 北京大学计算机网络课程第三讲第五部分 参考教材计算机网络-自顶向下方法" property=og:description><meta content=https://astro-theme-pure.vercel.app/blog/%E4%BC%A0%E8%BE%93%E5%B1%82-%E6%96%B0%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE property=og:url><meta content=Akiのink property=og:site_name><meta content=en_US property=og:locale><meta content=https://astro-theme-pure.vercel.app/images/social-card.png property=og:image><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><meta content=Aki property=article:author><meta content=2023-11-08T16:55:10.000Z property=article:published_time><meta content=summary_large_image property=twitter:card><meta content=https://astro-theme-pure.vercel.app/blog/%E4%BC%A0%E8%BE%93%E5%B1%82-%E6%96%B0%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE property=twitter:url><meta content=传输层-新型传输层协议 property=twitter:title><meta content=" 对应 北京大学计算机网络课程第三讲第五部分 参考教材计算机网络-自顶向下方法" property=twitter:description><meta content=https://astro-theme-pure.vercel.app/images/social-card.png property=twitter:image><meta content=@cworld0_cn name=telegram:channel><link href=/sitemap-index.xml rel=sitemap><link href=https://astro-theme-pure.vercel.app/rss.xml rel=alternate type=application/rss+xml title=Akiのink><meta content="Astro v4.16.10" name=generator><link href=/styles/global.css rel=stylesheet><vercel-speed-insights data-params={&#34;slug&#34;:&#34;传输层-新型传输层协议&#34;} data-pathname=/blog/%E4%BC%A0%E8%BE%93%E5%B1%82-%E6%96%B0%E5%9E%8B%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE data-props={}></vercel-speed-insights><script>console.log("%c Astro Theme Pure %c https://github.com/cworld1/astro-theme-pure/","color:#fff;background:linear-gradient(90deg,#448bff,#44e9ff);padding:5px 0;","color:#000;background:linear-gradient(90deg,#44e9ff,#ffffff);padding:5px 10px 5px 0px;")</script><link href=/_astro/_slug_.XaQ6XQsx.css rel=stylesheet><link href=/_astro/_slug_.BLJzc6jn.css rel=stylesheet><style>#waline[data-astro-cid-ksttp56e]{--waline-font-size:16px;--waline-white:hsl(var(--background) / var(--tw-bg-opacity));--waline-light-grey:#999;--waline-dark-grey:#666;--waline-theme-color:hsl(var(--foreground) / var(--tw-text-opacity));--waline-active-color:hsl(var(--primary) / var(--tw-text-opacity));--waline-color:hsl(var(--muted-foreground) / var(--tw-text-opacity));--waline-bg-color:hsl(var(--primary-foreground) / var(--tw-bg-opacity));--waline-bg-color-light:hsl(var(--input) / var(--tw-bg-opacity));--waline-bg-color-hover:#f0f0f0;--waline-border-color:hsl(var(--border) / var(--tw-border-opacity));--waline-disable-bg-color:#f8f8f8;--waline-disable-color:#bbb;--waline-code-bg-color:#282c34;--waline-bq-color:#f0f0f0;--waline-avatar-size:3.25rem;--waline-m-avatar-size:calc(var(--waline-avatar-size) * 9 / 13);--waline-badge-color:#3498db;--waline-badge-font-size:.775em;--waline-info-bg-color:var(--waline-bg-color-light);--waline-info-color:var(--waline-color);--waline-info-font-size:.625em;--waline-border:1px solid var(--waline-border-color);--waline-avatar-radius:50%;--waline-box-shadow:none}#waline[data-astro-cid-ksttp56e] .wl-reaction-title{display:none!important}#waline[data-astro-cid-ksttp56e] .wl-reaction{overflow:visible}#waline[data-astro-cid-ksttp56e] blockquote{position:relative;border-inline-start:4px solid transparent!important}#waline[data-astro-cid-ksttp56e] blockquote:before{content:"";height:100%;width:4px;left:-4px;top:0;position:absolute;border:2px solid var(--waline-bq-color)!important;border-radius:9999px}</style><link href=/_astro/_slug_.C639AhNv.css rel=stylesheet><script type=module src=/_astro/hoisted.B8nntUZK.js></script><script type=module src=/_astro/page.V2R8AmkL.js></script><script>window.va=window.va||function(){(window.vaq=window.vaq||[]).push(arguments)};var script=document.createElement("script");script.defer=!0,script.src="/_vercel/insights/script.js";var head=document.querySelector("head");head.appendChild(script)</script></head><body class="flex bg-background justify-center"><script>const lightModePref=window.matchMedia("(prefers-color-scheme: light)");function getUserPref(){return localStorage.getItem("theme")||(lightModePref.matches?"light":"dark")}function setTheme(e,t=!1){if(!["light","dark"].includes(e))return void console.log(`Invalid theme value '${e}' received. Expected 'light' or 'dark'.`);t&&localStorage.setItem("theme",e),document.documentElement.classList.toggle("dark","dark"===e);const r="dark"===e?"#0B0B10":"#FCFCFD";document.querySelector('meta[name="theme-color"]')?.setAttribute("content",r)}setTheme(getUserPref()),document.addEventListener("astro:after-swap",(()=>setTheme(getUserPref()))),document.addEventListener("theme-change",(e=>{const t=e.detail.theme;localStorage.setItem("theme",t),setTheme(e.detail.theme,!0)})),lightModePref.addEventListener("change",(e=>{setTheme(e.matches?"light":"dark")}))</script><main class="flex items-center flex-col leading-relaxed lg:px-10 max-w-[60rem] min-h-screen pb-10 px-4 sm:px-7 text-[0.92rem] w-screen z-10"><header-component class="transition-all py-1 border group [&#38;.not-top]:bg-background [&#38;.not-top]:border-border border-transparent box-content dark:[&#38;.not-top]:bg-primary-foreground duration-300 mb-16 rounded-xl sm:rounded-2xl sticky top-4 w-full z-30" data-astro-cid-qlfjksao><header class="flex flex-wrap sm:flex-nowrap sm:justify-start text-sm" data-astro-cid-qlfjksao><nav aria-label=global class="relative flex items-center justify-between mx-auto sm:flex sm:items-center w-full" data-astro-cid-qlfjksao><div class="hidden -left-4 -z-10 absolute box-content dark:max-sm:group-[.expanded]:bg-primary-foreground max-sm:group-[.expanded.not-top]:hidden max-sm:group-[.expanded]:block w-[calc(100%+2rem)] !duration-0 -top-8 h-20 max-sm:group-[.expanded]:bg-white" data-astro-cid-qlfjksao></div><a class="transition-all duration-300 flex-none font-semibold group-[.not-top]:ms-3 sm:group-[.not-top]:ms-5 text-xl" href=/ aria-label=Brand data-astro-cid-qlfjksao>Akiのink</a><div class="flex gap-x-4 sm:gap-x-6" data-astro-cid-qlfjksao><div class="transition-all duration-300 dark:group-[.expanded.not-top]:bg-primary-foreground end-0 grid group-[.expanded]:opacity-100 group-[.not-top]:rounded-xl max-md:border-b max-sm:absolute max-sm:group-[.expanded]:bg-background max-sm:group-[.not-top]:border max-sm:group-[.not-top]:pb-2 max-sm:group-[.not-top]:pt-2 max-sm:group-[.not-top]:px-4 max-sm:opacity-0 max-sm:pb-4 max-sm:pt-0 sm:border-0 sm:grid-rows-1 start-0 top-12 z-20" data-astro-cid-qlfjksao id=headerExpandConetent><div class="hidden -left-4 -z-10 absolute box-content dark:max-sm:group-[.expanded]:bg-primary-foreground max-sm:group-[.expanded.not-top]:hidden max-sm:group-[.expanded]:block w-[calc(100%+2rem)] bg-white h-full max-md:border-b top-0" data-astro-cid-qlfjksao></div><div class="transition-colors flex items-center flex-col gap-x-5 gap-y-2 justify-center overflow-hidden sm:flex-row sm:gap-x-7" data-astro-cid-qlfjksao><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/blog aria-label="Nav Menu Item" data-astro-cid-qlfjksao>Blog </a><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/projects aria-label="Nav Menu Item" data-astro-cid-qlfjksao>Projects </a><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/links aria-label="Nav Menu Item" data-astro-cid-qlfjksao>Links </a><a class="w-full grow sm:w-fit flex-none font-medium hover:text-primary py-2 text-[1.05rem] text-right" href=/about aria-label="Nav Menu Item" data-astro-cid-qlfjksao>About</a><div class="flex flex-row gap-x-3 grow justify-end sm:gap-x-5 sm:w-fit w-full" data-astro-cid-qlfjksao><a class="px-1 py-2" href=https://www.travellings.cn/go.html data-astro-cid-qlfjksao title=Travelling><span class=sr-only data-astro-cid-qlfjksao>Travelling</span> <svg class=size-5 data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-train-2-line data-astro-cid-qlfjksao></use></svg> </a><a class="px-1 py-2" href=/search data-astro-cid-qlfjksao title=Search><span class=sr-only data-astro-cid-qlfjksao>Search</span> <svg class=size-5 data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-search-2-line data-astro-cid-qlfjksao></use></svg></a></div></div></div><div class="transition-all gap-x-4 flex group-[.not-top]:gap-x-2 group-[.not-top]:me-1.5" data-astro-cid-qlfjksao><button class="transition-all border hover:bg-border p-1.5 rounded-md sm:group-[.not-top]:rounded-xl group/dark" id=toggleDarkMode data-astro-cid-qlfjksao><span class=sr-only data-astro-cid-qlfjksao>Dark Theme</span> <svg class="transition-all group-hover/dark:text-primary size-5 dark:hidden" data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-sun-line data-astro-cid-qlfjksao></use></svg> <svg class="transition-all group-hover/dark:text-primary size-5 dark:block hidden" data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-moon-stars-line data-astro-cid-qlfjksao></use></svg></button> <button class="transition-all border hover:bg-border p-1.5 rounded-md sm:group-[.not-top]:rounded-xl sm:hidden" id=toggleMenu data-astro-cid-qlfjksao><span class=sr-only data-astro-cid-qlfjksao>Menu</span> <svg class=size-5 data-astro-cid-qlfjksao><use href=/icons/header.svg#mingcute-menu-line data-astro-cid-qlfjksao></use></svg></button></div></div></nav></header></header-component><div class=w-full data-astro-cid-bvzihdzo style="--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))"><a class="transition-all py-1 border group bg-primary-foreground border-border gap-x-1 hover:bg-input inline-flex items-center no-underline px-2 rounded-lg text-muted-foreground text-sm" href=/blog data-astro-cid-bvzihdzo data-astro-prefetch><svg class="group-hover:stroke-primary stroke-muted-foreground" fill=none height=16 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=16 xmlns=http://www.w3.org/2000/svg><line class="transition-all duration-300 ease-in-out group-hover:scale-x-100 scale-x-0 group-hover:translate-x-0 translate-x-3" x1=19 x2=5 y1=12 y2=12></line><polyline class="transition-all duration-300 ease-in-out group-hover:translate-x-0 translate-x-1" points="12 19 5 12 12 5"></polyline></svg><p class=my-0>Back</p></a><div class="gap-x-10 lg:flex lg:items-start mt-8" data-astro-cid-bvzihdzo style="--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))"><aside class="animate -me-24 basis-60 max-lg:hidden order-2 sticky top-[15%]"><toc-heading><h2 class=font-semibold>TABLE OF CONTENTS</h2><ul class="max-h-[70vh] mt-4 overflow-y-scroll text-card-foreground"><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75" href=#新型传输层协议 aria-label="Scroll to section: 新型传输层协议">新型传输层协议</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp aria-label="Scroll to section: DCCP">DCCP</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#udp的问题 aria-label="Scroll to section: UDP的问题">UDP的问题</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#解决方案 aria-label="Scroll to section: 解决方案">解决方案</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp的报文格式 aria-label="Scroll to section: DCCP的报文格式">DCCP的报文格式</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp的报文类型 aria-label="Scroll to section: DCCP的报文类型">DCCP的报文类型</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp-连接 aria-label="Scroll to section: DCCP 连接">DCCP 连接</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dcp的交互流程 aria-label="Scroll to section: DCP的交互流程">DCP的交互流程</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp可靠传输 aria-label="Scroll to section: DCCP可靠传输">DCCP可靠传输</a></div></li></ul></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#dccp的拥塞控制机制 aria-label="Scroll to section: DCCP的拥塞控制机制">DCCP的拥塞控制机制</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#tcp-like-congestion-controlccid2 aria-label="Scroll to section: TCP-like Congestion Control（CCID2）">TCP-like Congestion Control（CCID2）</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#tcp-friendly-rate-controlccid3 aria-label="Scroll to section: TCP-Friendly Rate Control（CCID3）">TCP-Friendly Rate Control（CCID3）</a></div></li></ul></li></ul></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp aria-label="Scroll to section: MPTCP">MPTCP</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp的优势 aria-label="Scroll to section: MPTCP的优势">MPTCP的优势</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp在网络体系结构中的位置 aria-label="Scroll to section: MPTCP在网络体系结构中的位置">MPTCP在网络体系结构中的位置</a></div></li></ul></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp连接管理 aria-label="Scroll to section: MPTCP连接管理">MPTCP连接管理</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#初始化mptcp连接 aria-label="Scroll to section: 初始化MPTCP连接">初始化MPTCP连接</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#附加子流到mptcp连接上 aria-label="Scroll to section: 附加子流到MPTCP连接上">附加子流到MPTCP连接上</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp路径管理和关闭连接 aria-label="Scroll to section: MPTCP路径管理和关闭连接">MPTCP路径管理和关闭连接</a></div></li></ul></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp的数据调度 aria-label="Scroll to section: MPTCP的数据调度">MPTCP的数据调度</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#mptcp的拥塞机制 aria-label="Scroll to section: MPTCP的拥塞机制">MPTCP的拥塞机制</a></div></li></ul></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#quic aria-label="Scroll to section: QUIC">QUIC</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#tcp存在的问题 aria-label="Scroll to section: TCP存在的问题">TCP存在的问题</a></div><ul><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#quic在网络体系结构中的位置 aria-label="Scroll to section: QUIC在网络体系结构中的位置">QUIC在网络体系结构中的位置</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#quic包格式 aria-label="Scroll to section: QUIC包格式">QUIC包格式</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#连接时建立时延优化 aria-label="Scroll to section: 连接时建立时延优化">连接时建立时延优化</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#quic多数据流 aria-label="Scroll to section: QUIC多数据流">QUIC多数据流</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#无队头阻塞的多流复用 aria-label="Scroll to section: 无队头阻塞的多流复用">无队头阻塞的多流复用</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#明确的包序号和更精确的rtt aria-label="Scroll to section: 明确的包序号和更精确的RTT">明确的包序号和更精确的RTT</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#ip地址端口切换无需重新建立连接 aria-label="Scroll to section: IP地址/端口切换无需重新建立连接">IP地址/端口切换无需重新建立连接</a></div></li><li><div class=relative><span class="duration-300 transition-colors [&.highlight-bg]:bg-primary [&.readed]:bg-input absolute rounded top-[5%] w-[2px]"></span> <a class="transition-all py-1 [&#38;.highlight-bg-translucent]:bg-primary-foreground [&#38;.highlight]:font-medium [&#38;.highlight]:text-primary [&#38;.readed]:text-input flex-1 hover:text-foreground line-clamp-2 ms-2 px-3 text-foreground/75 ps-7" href=#quic易于部署和更新 aria-label="Scroll to section: QUIC易于部署和更新">QUIC易于部署和更新</a></div></li></ul></li></ul></li></ul></li></ul></li></ul></toc-heading></aside><article class="break-words flex-grow" data-astro-cid-bvzihdzo data-pagefind-body style="flex-grow:3;flex-shrink:1;flex-basis:60%;--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))"><div data-astro-cid-bvzihdzo style="--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))" id=blog-hero><div class="animate max-lg:mx-auto article-info max-w-[65ch]"><div class="flex flex-wrap gap-x-4 gap-y-2 leading-6 text-muted-foreground text-xs"><div class="flex items-center gap-1"><svg class=size-5><use href=/icons/ui.svg#mingcute-calendar-2-line></use></svg> <samp class=text-muted-foreground><time datetime=2023-11-08T16:55:10.000Z>Nov 9, 2023</time></samp></div><div class="flex items-center gap-1"><svg class=size-5><use href=/icons/ui.svg#mingcute-time-line></use></svg> 17 min read</div><span class="flex items-center gap-1"><svg class=size-5><use href=/icons/project.svg#mingcute-earth-2-line></use></svg> 中文</span></div><h1 class="font-medium mt-4 sm:mb-2 sm:mt-6 sm:text-3xl text-2xl">传输层-新型传输层协议</h1><div class="flex items-center flex-row flex-wrap gap-x-1 mt-3 sm:mt-5"><svg class=size-5><use href=/icons/ui.svg#mingcute-tag-line></use></svg><div><a class="before:content-['#'] hover:underline hover:underline-offset-4 inline-block" href=/tags/cn aria-label="View more blogs with the tag cn" data-pagefind-filter=tag>cn </a>,</div><div><a class="before:content-['#'] hover:underline hover:underline-offset-4 inline-block" href=/tags/传输层 aria-label="View more blogs with the tag 传输层" data-pagefind-filter=tag>传输层</a></div></div><div class="mt-3 italic"><blockquote class="text-muted-foreground text-sm"><q>对应 北京大学计算机网络课程第三讲第五部分 参考教材计算机网络-自顶向下方法</q></blockquote><div class="text-muted-foreground text-sm mt-1"><span class=waline-pageview-count data-path=/blog/传输层-新型传输层协议></span> views | <span class=waline-comment-count data-path=/blog/传输层-新型传输层协议></span> comments</div></div></div><div class="sm:mt-6 mt-4 border-t max-lg:mx-auto sm:w-1/3 w-1/2"></div></div><div class="text-muted-foreground dark:prose-invert mt-8 prose prose-base prose-headings:before:-ms-4 prose-headings:before:absolute prose-headings:font-medium prose-headings:text-foreground prose-th:before:content-none prose-zinc animate max-lg:mx-auto" data-astro-cid-bvzihdzo style="--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))" id=content><h1 id=计算机网络>计算机网络</h1><h2 id=新型传输层协议>新型传输层协议</h2><h4 id=dccp>DCCP</h4><h6 id=udp的问题>UDP的问题</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 一些容忍少量丢包、但延迟敏感的应用，适合采用UDP传输：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 如视频会议、在线游戏等</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 然而，UDP没有拥塞控制机制：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 拥塞发生时，UDP既感知不到拥塞，也不会降低其发送速率，从而影响应用性能，也影响网络的整体性能</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 对TCP协议极不友好，损害网络公平性（TCP让出的带宽都被UDP占了）</p><h6 id=解决方案>解决方案</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 给UDP增加拥塞控制机制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> DCCP=UDP+拥塞控制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 增加ACK报文、包序列号、面向连接等拥塞控制手段</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> DCCP提供不可靠数据报流服务：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> UDP报文段可能丢失、乱序到达</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 无流量控制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> DCCP提供模块化的拥塞控制：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 应用可以根据需要，选择不同的拥塞控制机制</p><h6 id=dccp的报文格式>DCCP的报文格式</h6><img alt="" decoding=async height=484 loading=lazy src=/_astro/CN801.8sMNJYsp_9i0RJ.webp width=968><h6 id=dccp的报文类型>DCCP的报文类型</h6><img alt="" decoding=async height=268 loading=lazy src=/_astro/CN802.Cpoyhkqw_Z1TMSFh.webp width=588><h6 id=dccp-连接>DCCP 连接</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> DCCP是面向连接的，两个主机之间有一个全双工连接：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 由两个方向的半连接组成</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 以A to B方向的半连接为例</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> A向B发送Data报文段</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> B向A发送ACK报文段</p><img alt="" decoding=async height=355 loading=lazy src=/_astro/CN803.DG4nVrff_Z1RBgks.webp width=1099><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 同一方向的ACK段和Data段可以合并成DataAck报文段</p><h6 id=dcp的交互流程>DCP的交互流程</h6><img alt="" decoding=async height=282 loading=lazy src=/_astro/CN804.bOAfZ4ZE_Z2n6G97.webp width=618><h6 id=dccp可靠传输>DCCP可靠传输</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> SeqNum与ACK只是用来拥塞控制，不要求可靠传输</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 接收方：ACK可以不含序列号（如CCID3，只反馈丢包率）</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 发送方：发现丢包也没有义务</p><h5 id=dccp的拥塞控制机制>DCCP的拥塞控制机制</h5><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> DCCP连接支持拥塞控制，应用可以根据需要选择不同的拥塞控制机制：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 组成一个连接的两个半连接，可以选择不同的拥塞控制机制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 不同的拥塞控制机制由一个1字节的CCID来标识，连接建立时两个终端协商确定</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 目前DCCP的RFC文档定义了两个CCID，分别是2和3，其余的值保留</p><h6 id=tcp-like-congestion-controlccid2>TCP-like Congestion Control（CCID2）</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 发送方维持一个发送窗口，并且不停地发包，直到没有可用的发送窗口</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 接收方对收到的包回复ACK报文，包括一段时间内收到的所有包的序号（用于支持SACK机制）</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 丢包或者ECN标记表示出现拥塞，此时发送端需要将发送窗口减半</p><h6 id=tcp-friendly-rate-controlccid3>TCP-Friendly Rate Control（CCID3）</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 接收方计算丢包率，报告给发送方</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 发送方根据丢包率计算发送速率，并根据发送速率发包</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 相比而言，CCID3可以更平滑地调节发包速率</p><h4 id=mptcp>MPTCP</h4><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 传统TCP协议仅支持单路径传输，即只能利用终端主机上的一个网络接口传输数据</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 随着接入技术的发展，同时具备多个网络接口的网络设备已经越来越普及，多路径传输更适合当前的网络环境</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 多路径TCP协议（MPTCP）应运而生，它可将单一数据流切分为若干子流，同时利用多条路径进行传输</p><h6 id=mptcp的优势>MPTCP的优势</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 多径带宽聚合</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 终端设备可以聚合不同路径上的可用带宽，以获得更高的网络带宽</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 提升传输的可靠性</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 使用多条路径传输数据，可以有效避免因单条路径性能恶化或中断导致的应用连接中断</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 支持链路的平滑切换</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 多路径传输方式允许终端在不同接入网络间快速、平滑地切换，选取当前链路质量最好的路径传输数据</p><h6 id=mptcp在网络体系结构中的位置>MPTCP在网络体系结构中的位置</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP位于套接字和TCP之间：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 应用程序通过套接字调用MPTCP，MPTCP向应用程序提供单条连接的抽象，因而对应用层透明</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP可在源主机和目的主机的多对网络接口间分别建立TCP连接，并将数据流分配到多条TCP连接上传输</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP兼容并扩展了TCP协议：TCP基本头不变，只定义了新的选项，从而对网络层也是透明</p><img alt="" decoding=async height=425 loading=lazy src=/_astro/CN805.RXzrXbsx_31ajy.webp width=849><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP连接是一个或多个子流的集合：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 路径：本地主机与远程主机之间可用于建立连接的一个链路序列称为路径，使用四元组&#x3C;本地IP地址，本地端口，远程IP地址，远程端口>表示</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 子流：在单个路径上运行的 TCP 流称为子流，是MPTCP连接的组成部分</p><h5 id=mptcp连接管理>MPTCP连接管理</h5><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 用于MPTCP连接管理的新字段：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MP_CAPABLE：建立MPTCP连接</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MP_JOIN：附加新的子流到已有连接</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> ADD_ADDR：新增可用路径</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> REMOVE_ADDR：删除路径</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MP_FASTCLOSE：关闭所有子流</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 如何建立MPTCP连接：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 首先初始化一条MPTCP连接（与建立常规TCP连接的过程相似）</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 然后将MPTCP的其它子流附加到已经存在的MPTCP连接上</p><img alt="" decoding=async height=267 loading=lazy src=/_astro/CN806.C0_omJ5H_1CunL5.webp width=250><h6 id=初始化mptcp连接>初始化MPTCP连接</h6><img alt="" decoding=async height=261 loading=lazy src=/_astro/CN807.DbP-Y9R__12H9Vt.webp width=604><h6 id=附加子流到mptcp连接上>附加子流到MPTCP连接上</h6><img alt="" decoding=async height=259 loading=lazy src=/_astro/CN808.CQw3qpR6_2lkc7Y.webp width=620><h6 id=mptcp路径管理和关闭连接>MPTCP路径管理和关闭连接</h6><img alt="" decoding=async height=282 loading=lazy src=/_astro/CN809.-d4Xj8-w_Z2laKdQ.webp width=618><h5 id=mptcp的数据调度>MPTCP的数据调度</h5><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 在多路径传输中，发送端将属于同一个数据流的数据包调度到不同的路径上传输，由于不同路径的差异，这些数据包往往无法按照发送顺序到达接收端</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 乱序到达的数据包需暂存在接收缓存中，直到接收缓中的数据包能够按序交付给上层应用，这既影响了数据传输的实时性，又影响了网络的吞吐量</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP根据拥塞窗口大小及路径延迟，将数据按比例分配给各个子流，尽力保证数据包按序到达接收端，降低数据乱序到达对网络性能产生的不利影响</p><h5 id=mptcp的拥塞机制>MPTCP的拥塞机制</h5><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> IETF MPTCP工作组提出的拥塞控制的设计目标</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 提升吞吐量：多路径TCP连接的各个子流获得的总吞吐量，不应低于其最优路径上单路径TCP连接的吞吐量</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 公平性：多路径TCP连接在同一网络瓶颈处的多个子流，不能过多地侵占其它单路径TCP连接的带宽</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 均衡拥塞：多路径TCP连接应能在满足前两个准则的情况下，实现各个子流之间的负载均衡，尽可能将拥塞路径上的流量迁移到较好的路径上</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 公平性是关注的重点，MPTCP采用的是网络公平性原则</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 举例：假设MPTCP的两个子流与一个常规TCP流共享一个网络瓶颈，则MPTCP两个子流获得的带宽应为瓶颈带宽的1/2，而不是2/3，这样才能保证MPTCP连接对常规TCP连接的友好性</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> MPTCP实现网络公平性准则的方法：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 限制各个子流窗口增长速度的总和，不超过单路径TCP连接的窗口增长速度</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 从而，MPTCP连接通过各子流获得的总吞吐量和单路径TCP连接获得的吞吐量相当</p><h4 id=quic>QUIC</h4><h6 id=tcp存在的问题>TCP存在的问题</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP 实现在操作系统内核中</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 作为传输优化的最终受益者，应用无法对TCP进行修改</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 操作系统的更新往往跟不上应用的需求和节奏</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP体系握手时延大</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 互联网上的大趋势：低时延需求越来越强烈；加密流量占比越来越大</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TLS(传输层安全性协议)+TCP的体系握手时延很大，传输前需要3个RTT进行握手</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP多流复用存在队头阻塞问题</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 当前的应用普遍比较复杂，常需要同时传输多个元素：例如：网页传输中，每个单独的图片即为一个数据流，不同数据流之间相互独立。为每个数据建立一个TCP连接很低效（尤其对于小流，单独建立连接成本高昂），因此出现了多流复用</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP传输需要保持有序性：出现丢包时，后面的数据需要等丢失的包重传完成才能使用，这就导致了队头阻塞</p><h6 id=quic在网络体系结构中的位置>QUIC在网络体系结构中的位置</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 传统的传输架构</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP提供数据传输服务</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TLS（传输层安全性协议）对数据进行加密</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> HTTP协议定义如何发起请求-响应请求</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 应用在HTTP之上实现</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 基于QUIC的传输架构</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC替代TCP、TLS和部分HTTP的功能</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC实现在用户态中</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 底层基于UDP实现</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 拥塞控制是模块化的，可以方便地使用各种TCP拥塞控制算法，如CUBIC等</p><img alt="" decoding=async height=203 loading=lazy src=/_astro/CN810.CuxHkaJs_YgNcn.webp width=321><h6 id=quic包格式>QUIC包格式</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 部分相关字段：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 连接标识符(Connection ID)：</p><p>用于对连接进行表示和识别</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 包号(Packet Number)：单调递增,</p><p>即同一个连接中，每个QUIC包的包号都不一样</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC底层使用UDP进传输</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC包作为UDP的数据载荷</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> IANA（互联网数字分配机构）建议QUIC使用UDP的443端口</p><img alt="" decoding=async height=218 loading=lazy src=/_astro/CN811.BWAe_Z1r_o8yGE.webp width=360><h6 id=连接时建立时延优化>连接时建立时延优化</h6><img alt="" decoding=async height=297 loading=lazy src=/_astro/CN812.BEfgcbJB_ZsxYkO.webp width=604><h6 id=quic多数据流>QUIC多数据流</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP：1个连接1对双向字节流</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC：多字节流</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 一个QUIC连接，可以用于传输多个字节流（streams）</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 每个QUIC报文，甚至可以包含来自多个stream的数据</p><img alt="" decoding=async height=266 loading=lazy src=/_astro/CN813.CAYQIt60_Z1SF7xE.webp width=417><h6 id=无队头阻塞的多流复用>无队头阻塞的多流复用</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP多流复用时的队头阻塞问题</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP为保持数据的有序性，出现丢包时，会等待该数据到达后，再提交给上层应用</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 多流复用时，某个数据流的数据包丢失，会使得TCP连接上所有数据流都需要等待</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC对队头阻塞问题的解决</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 在单个连接中，建立相互独立的多个QUIC流，某个流的数据包丢失不影响其它流的数据交付</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 分析：TCP保证了整个连接的数据交付的有序性（有序）; QUIC利用了各个流相互独立的特性，仅保持了流内部数据的有序性（部分有序），减少了不必要的等待</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 同时限制：单个流对接收端缓冲区的占用不能超过阈值</p><h6 id=明确的包序号和更精确的rtt>明确的包序号和更精确的RTT</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP中Seq的作用</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> ACK将Seq用于ACKNum，确认接收成功</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 接收端交付数据时，判断重复数据与顺序</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC：是否还使用同样作用的seq？</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 一个packet包含多个stream的frame</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 各个stream独立交付</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 因此，QUIC分离确认接收与向上层交付数据</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> Packet Number：ACK中确认packet接收</p><img alt="" decoding=async height=208 loading=lazy src=/_astro/CN814.DbjlvpzF_Z1TwYqf.webp width=296><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP重传歧义的问题：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP的重传包使用和原包相同的序号，因此可能某一序号被用了不止一次</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> TCP收到这一序号的ACK时，无法判断是针对哪个包的ACK，从而影响后续操作，如测量RTT的大小</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC解决重传歧义的方法：</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC的packet number单调递增，对于重传包也会递增packet number</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 每个packet number只会出现一次，ACK没有歧义！</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC接收端记录收到包与发出ACK之间的时延，并发馈给发送端，方便发送端更准确地测量RTT</p><h6 id=ip地址端口切换无需重新建立连接>IP地址/端口切换无需重新建立连接</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> IP地址/端口发生变化时，TCP连接会断开</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 例如手机WIFI断开时，常常自动转而使用移动信号</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 此时，TCP会断连，需要应用进行处理</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC支持IP/端口切换</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC使用Connection ID来表示每个连接</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> IP地址或端口的变化不影响对原有连接的识别</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 客户IP地址或端口发生变化时，QUIC可以快速恢复</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 由传输层对连接的切换进行管理</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 更符合互联网体系结构</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 不再需要应用重复造轮子</p><h6 id=quic易于部署和更新>QUIC易于部署和更新</h6><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 整个QUIC包被加密传输</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 保护用户数据隐私</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 避免被中间设备识别和修改</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> QUIC在用户态实现</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 与操作系统解耦，从而能和应用一同快速迭代</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 如：预留接口，用户自定义拥塞控制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 版本协商机制</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 由于QUIC的快速迭代特性，会同时存在众多QUIC版本</p><p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mspace width=1em></mspace></mrow><annotation encoding=application/x-tex>\quad</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:0></span><span class=mspace style=margin-right:1em></span></span></span></span> 客户需要和服务器进行版本协商（不引入额外时延的协商机制</p><hr></div></article></div><div class="text-muted-foreground dark:prose-invert mt-8 prose prose-base prose-headings:before:-ms-4 prose-headings:before:absolute prose-headings:font-medium prose-headings:text-foreground prose-th:before:content-none prose-zinc" data-astro-cid-bvzihdzo style="--primaryColor:hsl(var(--primary) / var(--tw-text-opacity))"><div class="relative flex border flex-col gap-y-2 px-3 py-2 rounded-xl sm:px-4 sm:py-3"><svg class="opacity-10 absolute end-4 size-20 top-4"><use href=/icons/copyright-sponsor.svg#mingcute-copyright-line></use></svg><div class="flex flex-col"><div class=text-foreground>传输层-新型传输层协议</div><div class=text-sm>https://astro-theme-pure.vercel.app/blog/传输层-新型传输层协议</div></div><div class="flex flex-row flex-wrap gap-x-5 gap-y-1 justify-start sm:gap-x-8"><div class="flex gap-x-2 sm:flex-col"><span class=text-foreground>Author</span> <span class="text-sm max-sm:place-self-center">Aki</span></div><div class="flex gap-x-2 sm:flex-col sm:min-w-16"><span class=text-foreground>Update date</span> <span class="text-sm max-sm:place-self-center">November 9, 2023</span></div><div class="flex gap-x-2 sm:flex-col"><span class=text-foreground>Copyright</span> <a class="text-muted-foreground text-sm max-sm:place-self-center" href=https://creativecommons.org/licenses/by/4.0/ target=_blank>CC BY-NC-SA 4.0</a></div></div><div class=relative><div class="flex flex-row gap-3"><button class="transition-colors group bg-primary-foreground hover:text-primary p-1 rounded-full sm:p-1.5 text-muted-foreground" id=copy-link><svg class=size-5><use href=/icons/copyright-sponsor.svg#mingcute-link-2-line></use></svg></button><button class="transition-colors group bg-primary-foreground hover:text-primary p-1 rounded-full sm:p-1.5 text-muted-foreground" id=get-qrcode><svg class=size-5><use href=/icons/copyright-sponsor.svg#mingcute-qrcode-2-line></use></svg></button><button class="transition-colors group bg-primary-foreground hover:text-primary p-1 rounded-full sm:p-1.5 text-muted-foreground" id=share-weibo><svg class=size-5><use href=/icons/copyright-sponsor.svg#mingcute-weibo-line></use></svg></button></div><div class="transition-all duration-300 ease-in-out *:my-0 -mt-2 absolute aria-expanded:max-h-[256px] aria-expanded:opacity-100 aria-expanded:translate-y-4 bg-primary-foreground border box-content max-h-0 opacity-0 overflow-hidden p-4 rounded-xl z-10" id=qrcode aria-expanded=false></div></div></div><div class="px-3 border sm:px-4 border-t-0 mx-6 pb-1.5 pt-1 rounded-b-xl sm:mx-8"><a class="flex justify-between no-underline text-muted-foreground" href=/projects#sponsorship target=_blank><div>Buy me a cup of coffee ☕.</div><svg class="size-5 m-1"><use href=/icons/copyright-sponsor.svg#mingcute-receive-money-line></use></svg></a></div><script type=module>import QRCode from"/scripts/qrcode.js";const link=window.location.href,copyLink=document.getElementById("copy-link");function loadqrcode(e){if(!e)throw new Error("qrcode container not found");""===e.innerHTML&&new QRCode(e,link)}copyLink?.addEventListener("click",(()=>{navigator.clipboard.writeText(link)}));const getQRCode=document.getElementById("get-qrcode"),qrcodeContainer=document.getElementById("qrcode");if(!qrcodeContainer)throw new Error("qrcode container not found");getQRCode?.addEventListener("click",(()=>{"true"===qrcodeContainer.ariaExpanded?qrcodeContainer.ariaExpanded="false":(loadqrcode(qrcodeContainer),qrcodeContainer.ariaExpanded="true")}));const shareWeibo=document.getElementById("share-weibo");shareWeibo?.addEventListener("click",(()=>{const e=`http://service.weibo.com/share/share.php?url=${link}&title=${document.title}&pic=https://cravatar.cn/avatar/1ffe42aa45a6b1444a786b1f32dfa8aa?s=400`;window.open(e,"_blank")}))</script><div class="mt-3 sm:mt-6 gap-2 grid grid-cols-1 sm:gap-4 sm:grid-cols-2"><a class="duration-300 transition-colors border border-transparent flex gap-3 group hover:bg-primary-foreground items-center no-underline px-4 py-2 rounded-lg sm:py-4" href=/blog/网络层---基本概念路由器><svg class="transition-colors group-hover:stroke-primary stroke-muted-foreground rotate-180" fill=none height=20 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=20 xmlns=http://www.w3.org/2000/svg><line class="transition-all duration-300 ease-in-out group-hover:translate-x-1 group-hover:scale-x-100 scale-x-0 translate-x-4" x1=5 x2=19 y1=12 y2=12></line><polyline class="transition-all duration-300 ease-in-out group-hover:translate-x-1 translate-x-0" points="12 5 19 12 12 19"></polyline></svg><div class="flex flex-col gap-0.5 grow max-w-[80%] sm:gap-1.5"><div class="text-muted-foreground text-sm font-normal uppercase">Prev</div><div class="transition-colors font-medium truncate whitespace-nowrap">网络层 - 基本概念，路由器</div></div></a><a class="duration-300 transition-colors border border-transparent flex gap-3 group hover:bg-primary-foreground items-center no-underline px-4 py-2 rounded-lg sm:py-4 justify-end text-right" href=/blog/传输层-新型拥塞控制><div class="flex flex-col gap-0.5 grow max-w-[80%] sm:gap-1.5"><div class="text-muted-foreground text-sm font-normal uppercase">Next</div><div class="transition-colors font-medium truncate whitespace-nowrap">传输层-新型拥塞控制</div></div><svg class="transition-colors group-hover:stroke-primary stroke-muted-foreground" fill=none height=20 stroke-linecap=round stroke-linejoin=round stroke-width=2.5 viewBox="0 0 24 24" width=20 xmlns=http://www.w3.org/2000/svg><line class="transition-all duration-300 ease-in-out group-hover:translate-x-1 group-hover:scale-x-100 scale-x-0 translate-x-4" x1=5 x2=19 y1=12 y2=12></line><polyline class="transition-all duration-300 ease-in-out group-hover:translate-x-1 translate-x-0" points="12 5 19 12 12 19"></polyline></svg></a></div><comment-component data-astro-cid-ksttp56e><div class="mt-3 sm:mt-6 not-prose" id=waline data-astro-cid-ksttp56e>Comment seems to stuck. Try to refresh?✨</div></comment-component></div><button class="transition-all duration-300 bg-primary-foreground opacity-0 border-2 border-transparent bottom-8 data-[show=true]:opacity-100 data-[show=true]:translate-y-0 end-4 fixed flex group h-10 hover:border-border/75 items-center justify-center rounded-full sm:end-8 sm:h-12 sm:w-12 text-muted-foreground translate-y-28 w-10 z-90" id=to-top-btn aria-label="Back to Top" data-show=false><div class="flex items-center justify-center absolute bottom-0 end-0 group-[.ended]:opacity-0 group-hover:opacity-0 start-0 top-0 transition-opacity"><span class=text>10</span> <span class=text-xs>%</span></div><svg class="size-6 group-[.ended]:opacity-100 group-hover:opacity-100 opacity-0 transition-opacity"><use href=/icons/ui.svg#mingcute-up-line></use></svg></button><script>!function(){const e=document.getElementById("to-top-btn"),t=e.children[0].children[0],n=document.getElementById("blog-hero"),o=document.getElementById("content");e.addEventListener("click",(()=>{document.documentElement.scrollTo({behavior:"smooth",top:0})}));new IntersectionObserver((function(t){t.forEach((t=>{e.dataset.show=(!t.isIntersecting).toString()}))})).observe(n);{const n=o.scrollHeight,c=o.offsetTop,d=document.documentElement.clientHeight;document.addEventListener("scroll",(()=>{const o=function(){var e=document.documentElement.scrollTop||document.body.scrollTop;if(!(e<c))return Math.round((e-c)/(n-d)*100)}();void 0!==o&&(t.innerText=o.toString(),e.classList.toggle("ended",o>100))}))}}()</script></div><footer class="w-full mx-auto mt-24"><div class="border-t border-border pt-5"><div class="flex items-center flex-col sm:flex-row gap-y-3 sm:flex sm:gap-y-0 sm:items-center sm:justify-between"><div class="flex items-center flex-col sm:flex-row gap-2 sm:gap-x-4 text-sm"><p class="">© <samp>2024</samp> Aki. All rights reserved.</p></div><div class="flex items-center justify-between"><div class="flex items-center gap-x-4"><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=https://github.com/Aki-yzh aria-label=github><svg class=size-6><use href=/icons/social.svg#mingcute-github-line></use></svg> </a><a class="transition-all text-muted-foreground hover:text-muted-foreground/75 inline-block" href=/rss.xml aria-label=rss><svg class=size-6><use href=/icons/social.svg#mingcute-rss-2-line></use></svg></a></div></div></div></div></footer></main></body></html>